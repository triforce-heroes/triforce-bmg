import{existsSync as o,readFileSync as t,writeFileSync as r}from"node:fs";import{normalize as e}from"node:path";import{fatal as i}from"@triforce-heroes/triforce-core";import{extract as n,getEntries as s,getStrings as f}from"../Extract.js";export function TranspileCommand(p,m){o(p)||i(`File not found: ${p}`);let l=e(m??`${p}.json`);process.stdout.write(`Transpiling ${e(p)} to ${l}... `);let a=new Map(n(t(p))),c=s(a.get("INF1")),d=new Map(f(c,a.get("DAT1"))),u=[];for(let[,o]of c)if(0!==o){let t=d.get(o);void 0!==t&&u.push([o,t])}r(l,JSON.stringify(u,null,2)),process.stdout.write("OK\n")}